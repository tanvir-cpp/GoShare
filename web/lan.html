<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>GoShare â€” LAN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              bg: "#0f172a",
              card: "#1e293b",
              "card-hover": "#334155",
              border: "#334155",
              accent: "#3b82f6",
              "accent-soft": "rgba(59,130,246,0.1)",
              success: "#10b981",
              danger: "#ef4444",
              warning: "#f59e0b",
              muted: "#94a3b8",
            },
          },
        },
      };
    </script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap");
      body {
        font-family: "Inter", system-ui, sans-serif;
      }

      /* Ripple ring animation */
      .me-ring {
        position: absolute;
        top: 50%;
        left: 50%;
        border-radius: 50%;
        border: 1px solid #3b82f6;
        transform: translate(-50%, -50%);
        animation: ripple 4s cubic-bezier(0, 0.2, 0.8, 1) infinite;
      }
      @keyframes ripple {
        0% {
          width: clamp(80px, 25vw, 100px);
          height: clamp(80px, 25vw, 100px);
          opacity: 1;
        }
        100% {
          width: clamp(240px, 80vw, 300px);
          height: clamp(240px, 80vw, 300px);
          opacity: 0;
        }
      }

      /* Peer pop-in */
      .peer {
        animation: peer-in 0.4s ease-out both;
      }
      @keyframes peer-in {
        from {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.5);
        }
        to {
          opacity: 1;
        }
      }
      .peer:hover {
        transform: translate(-50%, -50%) scale(1.1) rotate(2deg) !important;
        z-index: 10;
      }

      /* Toast slide-up */
      .toast-show {
        opacity: 1 !important;
        transform: translateX(-50%) translateY(0) !important;
      }

      /* Notif slide-in */
      .notif-show {
        opacity: 1 !important;
        transform: translateY(0) scale(1) !important;
        pointer-events: auto !important;
      }

      /* Modal overlay */
      .modal-overlay {
        display: none;
      }
      .modal-overlay.open {
        display: flex;
      }

      /* Scrollbar hide for shared bar */
      .shared-bar::-webkit-scrollbar {
        display: none;
      }
      .shared-bar {
        scrollbar-width: none;
      }
    </style>
  </head>
  <body
    class="bg-bg bg-[radial-gradient(circle_at_50%_-20%,#1e293b_0%,#0f172a_100%)] min-h-screen text-white flex flex-col items-center pt-8 pb-20 overflow-x-hidden"
  >
    <!-- App Container -->
    <div class="relative z-[1] text-center w-full max-w-[600px] px-4">
      <!-- Header -->
      <header>
        <h1
          class="text-[clamp(1.5rem,8vw,2.2rem)] font-extrabold tracking-tight mb-2"
        >
          <span class="text-accent">Go</span>Share
        </h1>
        <p class="text-muted text-[clamp(0.8rem,4vw,0.95rem)]">
          LAN File Sharing &bull; Instant &amp; Private
        </p>
        <div
          id="urlBox"
          onclick="copyUrl()"
          title="Click to copy URL"
          class="mt-4 inline-flex items-center gap-3 px-4 py-2.5 bg-card border border-border rounded-xl text-sm text-accent cursor-pointer transition-all hover:border-accent hover:bg-card-hover hover:-translate-y-0.5 shadow-md max-w-full overflow-hidden"
        >
          <span
            id="shareUrl"
            class="whitespace-nowrap overflow-hidden text-ellipsis"
            >Loading...</span
          >
          <svg
            class="w-4 h-4 flex-shrink-0 opacity-60"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9.75a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"
            />
          </svg>
        </div>
      </header>

      <!-- Device Area -->
      <div
        id="deviceArea"
        class="relative mx-auto mt-8 w-[min(340px,90vw)] h-[min(340px,90vw)] bg-[radial-gradient(circle,rgba(51,65,85,0.2)_0%,transparent_70%)] rounded-full"
      >
        <div class="me-ring"></div>
        <!-- Me Node -->
        <div
          onclick="openSharedUpload()"
          class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[clamp(80px,25vw,100px)] h-[clamp(80px,25vw,100px)] rounded-full bg-card border-2 border-accent flex flex-col items-center justify-center cursor-pointer z-[5] shadow-lg"
        >
          <div id="meIcon" class="w-8 h-8 text-accent"></div>
          <div
            id="meName"
            class="text-[clamp(0.6rem,2vw,0.75rem)] text-white mt-0.5 font-bold"
          ></div>
          <div class="text-[0.6rem] text-muted uppercase tracking-wider">
            You
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="mt-8 px-4">
        <div
          id="deviceCount"
          class="inline-block px-3 py-1 bg-accent-soft text-accent rounded-full text-xs font-bold mb-4"
        >
          0 devices online
        </div>
        <p class="text-sm text-muted">
          Share the URL above to start transferring files
        </p>
      </div>
    </div>

    <!-- Shared Files Bar (fixed bottom) -->
    <div
      id="sharedBar"
      class="fixed bottom-0 left-0 right-0 bg-bg/90 backdrop-blur-xl border-t border-border py-3 px-3 z-[100] flex items-center gap-3 overflow-x-auto shared-bar"
    >
      <button
        onclick="openSharedUpload()"
        title="Upload files to shared space"
        class="flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-accent rounded-xl text-white text-sm font-semibold cursor-pointer transition-all hover:bg-blue-600"
      >
        <svg
          class="w-4 h-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"
          />
        </svg>
        Upload File
      </button>
    </div>

    <!-- Send File Modal -->
    <div
      class="modal-overlay fixed inset-0 bg-bg/75 backdrop-blur-sm z-[200] items-center justify-center"
      id="modalOverlay"
    >
      <div
        class="bg-card border border-border rounded-3xl p-10 w-[90%] max-w-[400px] shadow-2xl"
      >
        <h2 class="text-xl font-bold mb-6">Send file to</h2>
        <div id="modalIcon" class="w-12 h-12 mx-auto text-accent my-2"></div>
        <div id="modalName" class="text-accent font-semibold mb-4"></div>

        <div
          id="modalDropArea"
          class="border-2 border-dashed border-border bg-bg/30 rounded-2xl p-12 mb-6 cursor-pointer transition-all hover:border-accent hover:bg-accent-soft flex flex-col items-center"
        >
          <svg
            class="w-10 h-10 text-muted mb-3"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"
            />
          </svg>
          <strong>Drag & Drop files here</strong>
          <p class="mt-2 text-sm opacity-80">or click to browse</p>
        </div>
        <input type="file" id="modalFileInput" multiple class="hidden" />

        <div id="transferProgress" class="mt-4 hidden">
          <div class="h-2 bg-bg rounded-full overflow-hidden">
            <div
              id="transferFill"
              class="h-full bg-accent rounded-full transition-all duration-200 shadow-[0_0_10px_rgba(59,130,246,0.5)]"
              style="width: 0"
            ></div>
          </div>
          <div class="text-sm text-white mt-2 font-medium">
            <span id="transferPercent">0%</span> &bull;
            <span id="transferStatus">Preparing...</span>
          </div>
        </div>

        <button
          onclick="closeModal()"
          class="w-full py-3 mt-2 rounded-xl font-semibold cursor-pointer bg-transparent text-muted hover:text-white hover:bg-white/5 transition"
        >
          Cancel
        </button>
      </div>
    </div>

    <!-- Shared Upload Modal -->
    <div
      class="modal-overlay fixed inset-0 bg-bg/75 backdrop-blur-sm z-[200] items-center justify-center"
      id="sharedOverlay"
    >
      <div
        class="bg-card border border-border rounded-3xl p-10 w-[90%] max-w-[400px] shadow-2xl"
      >
        <h2
          class="text-xl font-bold mb-2 flex items-center justify-center gap-2"
        >
          <svg
            class="w-6 h-6 text-accent"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"
            />
          </svg>
          Shared Space
        </h2>
        <p class="text-muted text-sm -mt-0 mb-6">
          Anyone on the network can see these files
        </p>

        <div
          id="sharedDropArea"
          class="border-2 border-dashed border-border bg-bg/30 rounded-2xl py-8 px-4 cursor-pointer transition-all hover:border-accent hover:bg-accent-soft flex flex-col items-center"
        >
          <strong>Tap to Upload</strong>
          <p class="mt-1 text-xs opacity-70">or drag files here</p>
        </div>
        <input type="file" id="sharedFileInput" multiple class="hidden" />

        <div id="sharedProgress" class="mt-4 hidden">
          <div class="h-2 bg-bg rounded-full overflow-hidden">
            <div
              id="sharedFill"
              class="h-full bg-accent rounded-full transition-all duration-200 shadow-[0_0_10px_rgba(59,130,246,0.5)]"
              style="width: 0"
            ></div>
          </div>
          <p class="text-sm mt-2">
            <span id="sharedPercent">0%</span> &bull;
            <span id="sharedStatus"></span>
          </p>
        </div>

        <button
          onclick="closeSharedOverlay()"
          class="w-full py-3 mt-4 rounded-xl font-semibold cursor-pointer bg-transparent text-muted hover:text-white hover:bg-white/5 transition"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Notification -->
    <div
      id="notif"
      class="fixed top-6 right-6 z-[300] bg-card border border-accent rounded-2xl p-5 w-80 shadow-2xl opacity-0 -translate-y-5 scale-95 transition-all duration-400 pointer-events-none"
      style="
        transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
      "
    >
      <div class="flex items-center gap-3 mb-4 max-w-full">
        <div class="flex-shrink-0 w-6 h-6 text-accent">
          <svg
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 3.75H6.912a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H15M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.218a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859M12 3v8.25m0 0-3-3m3 3 3-3"
            />
          </svg>
        </div>
        <div class="min-w-0">
          <span id="notifTitle" class="block font-medium text-sm"
            >New File Received</span
          >
          <span id="notifSub" class="block text-xs text-muted truncate"
            >filename.ext</span
          >
        </div>
      </div>
      <button
        onclick="downloadNotifFile()"
        class="w-full py-2.5 rounded-xl font-semibold bg-accent text-white cursor-pointer hover:bg-blue-600 transition"
      >
        Download
      </button>
    </div>

    <!-- Toast -->
    <div
      id="toast"
      class="fixed bottom-24 left-1/2 -translate-x-1/2 translate-y-5 bg-accent text-white px-5 py-2.5 rounded-full text-sm font-semibold z-[400] opacity-0 transition-all duration-300 pointer-events-none shadow-lg"
    >
      Copied to clipboard!
    </div>

    <script src="/app.js"></script>
  </body>
</html>
