<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
  <title>GoShare — Send Anywhere</title>
  <meta name="description" content="Send files to anyone across the world with an encrypted link" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            bg: "#0d0d12",
            card: "#18181b",
            "card-hover": "#252529",
            border: "rgba(255, 255, 255, 0.04)",
            accent: "#818cf8",
            "accent-soft": "rgba(129, 140, 248, 0.05)",
            success: "#34d399",
            danger: "#f87171",
            muted: "#71717a",
          },
          borderRadius: {
            soft: "1rem",
            "soft-lg": "1.5rem",
          },
        },
      },
    };
  </script>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Hanken+Grotesk:wght@400;500;600;700&display=swap");

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body {
      font-family: "Hanken Grotesk", system-ui, sans-serif;
      touch-action: manipulation;
      -webkit-text-size-adjust: 100%;
    }

    input {
      font-size: 16px !important;
    }

    .app-entrance {
      animation: fade-in 0.5s ease-out both;
    }

    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(8px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .grid-bg {
      background-image:
        radial-gradient(circle at 50% 50%, rgba(129, 140, 248, 0.02) 0%, transparent 50%),
        linear-gradient(to right, rgba(255, 255, 255, 0.005) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255, 255, 255, 0.005) 1px, transparent 1px);
      background-size: 100% 100%, 60px 60px, 60px 60px;
    }

    .pulse {
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    #qrcode canvas {
      border-radius: 8px;
      max-width: 100%;
      height: auto !important;
    }

    .modal-overlay {
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.open {
      display: flex;
      opacity: 1;
    }

    .modal-content {
      transition: transform 0.3s ease-out;
    }

    .modal-overlay.open .modal-content {
      transform: scale(1);
    }

    .file-select-area {
      aspect-ratio: 16 / 10;
    }

    @media (max-width: 480px) {
      .file-select-area {
        aspect-ratio: 4 / 3;
      }
    }

    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }

    /* Progress bar glow */
    .progress-glow {
      box-shadow: 0 0 12px rgba(129, 140, 248, 0.5), 0 0 4px rgba(129, 140, 248, 0.3);
    }

    /* Success animation */
    @keyframes checkmark-draw {
      0% {
        stroke-dashoffset: 24;
      }

      100% {
        stroke-dashoffset: 0;
      }
    }

    .check-animate path {
      stroke-dasharray: 24;
      stroke-dashoffset: 24;
      animation: checkmark-draw 0.4s ease-out 0.1s forwards;
    }

    @keyframes success-pulse {

      0%,
      100% {
        box-shadow: 0 0 0 0 rgba(52, 211, 153, 0.4);
      }

      50% {
        box-shadow: 0 0 0 16px rgba(52, 211, 153, 0);
      }
    }

    .success-ring {
      animation: success-pulse 1.5s ease-in-out 1;
    }
  </style>
</head>

<body class="bg-bg grid-bg min-h-screen w-screen text-white flex flex-col items-center select-none overflow-x-hidden">
  <!-- ═══ NAVBAR ═══ -->
  <nav
    class="fixed top-0 left-0 right-0 h-14 border-b border-white/[0.04] bg-bg/80 backdrop-blur-xl z-[150] flex items-center px-4 sm:px-6 lg:px-8 justify-between">
    <!-- Left: Logo + Page label -->
    <div class="flex items-center gap-3 sm:gap-4">
      <a href="/" class="font-semibold text-base tracking-tight hover:opacity-70 transition">
        <span class="text-blue-500">go</span>share
      </a>
      <div class="hidden sm:flex items-center gap-2">
        <div class="w-1 h-1 rounded-full bg-zinc-600"></div>
        <span class="text-xs text-zinc-500 font-medium">Send Anywhere</span>
      </div>
    </div>

    <!-- Right: Nav links + Settings -->
    <div class="flex items-center gap-2 sm:gap-3">
      <a href="/lan.html"
        class="flex items-center gap-1.5 px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium text-zinc-400 hover:text-white hover:bg-white/[0.05] transition-all">
        <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z" />
        </svg>
        <span class="hidden sm:inline">Nearby</span>
        <span class="sm:hidden">LAN</span>
      </a>
      <button onclick="changeName()" title="Change your name"
        class="w-9 h-9 flex items-center justify-center rounded-full text-zinc-500 hover:text-white hover:bg-white/[0.06] transition-all">
        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path d="M12 15a3 3 0 100-6 3 3 0 000 6z" />
          <path
            d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" />
        </svg>
      </button>
      <div class="w-2 h-2 rounded-full bg-success animate-pulse" title="Connected"></div>
    </div>
  </nav>

  <main
    class="app-entrance flex-1 flex flex-col items-center justify-center w-full max-w-3xl px-4 sm:px-6 pt-20 pb-8 sm:pb-14">
    <!-- SENDER VIEW (default) -->
    <div id="senderView" class="w-full">
      <div class="text-center mb-6 sm:mb-8">
        <div
          class="inline-flex items-center gap-2 px-3 py-1.5 bg-white/[0.03] border border-white/[0.05] rounded-full text-xs sm:text-sm font-medium text-zinc-400 mb-4 sm:mb-5">
          <span>Your name:</span>
          <span id="userNameDisplay" class="text-white">Anonymous</span>
        </div>
        <h1 class="text-2xl sm:text-4xl lg:text-5xl font-semibold tracking-tighter mb-2 text-white">
          Send Anywhere
        </h1>
        <p class="text-zinc-500 text-sm sm:text-base font-medium">
          Share files with anyone, anywhere in the world
        </p>
      </div>

      <!-- File Select Area -->
      <div id="fileSelectArea"
        class="file-select-area max-w-md mx-auto bg-white/[0.02] border border-dashed border-white/[0.1] rounded-xl sm:rounded-2xl p-6 sm:p-12 text-center cursor-pointer hover:bg-white/[0.04] transition-colors flex flex-col items-center justify-center group"
        onclick="document.getElementById('fileInput').click()">
        <div
          class="w-10 h-10 sm:w-12 sm:h-12 mb-4 bg-white/[0.03] border border-white/[0.05] rounded-xl flex items-center justify-center text-zinc-400 group-hover:scale-110 transition-transform">
          <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z" />
          </svg>
        </div>
        <span class="text-sm font-medium text-white/60">Drop files here or tap to browse</span>
      </div>
      <input type="file" id="fileInput" multiple class="hidden" />

      <div id="selectedFile" class="hidden max-w-md mx-auto mt-8">
        <div id="fileList" class="space-y-2 mb-6 max-h-48 overflow-y-auto scrollbar-hide"></div>
        <button id="shareBtn" onclick="createRoom()"
          class="w-full py-3.5 bg-white text-black rounded-full text-sm font-semibold transition-opacity hover:opacity-90 active:scale-95">
          Create share link
        </button>
      </div>

      <!-- Share Link + QR -->
      <div id="shareInfo" class="hidden max-w-md mx-auto mt-8">
        <div class="bg-card border border-white/[0.05] rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center shadow-2xl">
          <p class="text-zinc-500 text-xs sm:text-sm font-medium mb-5 sm:mb-6">
            Share this link with the recipient
          </p>
          <div id="qrcode" class="flex justify-center mb-6 sm:mb-8 p-4 sm:p-6 bg-white rounded-xl overflow-hidden">
          </div>
          <div
            class="flex items-center gap-2 bg-white/[0.02] border border-white/[0.05] rounded-full pl-4 sm:pl-5 pr-2 py-2">
            <span class="flex-1 text-xs sm:text-sm truncate text-zinc-400 font-mono" id="shareUrl"></span>
            <button onclick="copyLink()"
              class="flex-shrink-0 px-4 py-2 bg-white text-black rounded-full text-xs sm:text-sm font-semibold hover:opacity-90 transition-opacity active:scale-95">
              Copy link
            </button>
          </div>
          <div id="waitingStatus"
            class="mt-8 flex items-center justify-center gap-2 text-zinc-500 text-xs sm:text-sm font-medium">
            <div class="w-1.5 h-1.5 rounded-full bg-accent animate-pulse"></div>
            Waiting for someone to join...
          </div>
        </div>
      </div>

      <!-- Transfer Overlay -->
      <div id="transferOverlay"
        class="fixed inset-0 bg-bg/95 backdrop-blur-3xl z-[1000] items-center justify-center p-5 sm:p-6 text-white text-center"
        style="display: none">
        <div class="w-full max-w-sm scale-95 opacity-0 transition-all duration-300" id="transferCard">

          <!-- Icon -->
          <div class="flex justify-center mb-6">
            <div id="transferIcon"
              class="w-16 h-16 sm:w-20 sm:h-20 bg-white/[0.03] border border-white/[0.05] rounded-2xl flex items-center justify-center transition-all duration-300">
              <svg class="w-7 h-7 sm:w-8 sm:h-8 text-zinc-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
              </svg>
            </div>
          </div>

          <!-- File name + stage -->
          <div class="text-center mb-8">
            <h2 id="transferName" class="text-base sm:text-lg font-semibold tracking-tight truncate mb-1">Sending...
            </h2>
            <p id="transferStage" class="text-xs sm:text-sm text-zinc-500 font-medium">Getting ready...</p>
          </div>

          <!-- Progress bar -->
          <div class="mb-3">
            <div class="flex items-center justify-between mb-2">
              <span id="uiPercent" class="text-xl sm:text-2xl font-bold font-mono tabular-nums">0%</span>
              <span id="uiEta" class="text-sm sm:text-base text-zinc-400 font-mono tabular-nums">--:--</span>
            </div>
            <div class="relative w-full h-2.5 sm:h-3 bg-white/[0.06] rounded-full overflow-hidden">
              <div id="transferBar"
                class="absolute inset-y-0 left-0 bg-accent rounded-full transition-all duration-300 progress-glow"
                style="width: 0%"></div>
            </div>
          </div>

          <!-- Speed -->
          <div class="flex items-center justify-between mb-8 sm:mb-10">
            <div class="flex items-center gap-2">
              <svg class="w-3.5 h-3.5 text-zinc-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5" />
              </svg>
              <span id="uiSpeed" class="text-sm text-zinc-400 font-mono tabular-nums">0 MB/s</span>
            </div>
            <span class="text-xs text-zinc-600 font-medium">Time remaining</span>
          </div>

          <button id="abortBtn" onclick="abortTransfer()"
            class="w-full py-3.5 border border-white/[0.08] text-sm font-medium hover:bg-danger/20 hover:border-danger/30 hover:text-danger transition-colors rounded-full active:scale-95">
            Cancel
          </button>

          <button id="successCloseBtn" onclick="closeTransferOverlay()"
            class="hidden w-full py-3.5 mt-3 bg-white text-black text-sm font-semibold rounded-full transition-all active:scale-95">
            Done
          </button>
        </div>
      </div>
    </div>

    <!-- RECEIVER VIEW -->
    <div id="receiverView" class="hidden w-full">
      <div class="text-center mb-8 sm:mb-12">
        <div
          class="inline-flex items-center gap-2 px-3 py-1.5 bg-white/[0.03] border border-white/[0.05] rounded-full text-xs sm:text-sm font-medium text-zinc-400 mb-4 sm:mb-6">
          <span>From:</span>
          <span id="remoteUserName" class="text-white">Someone</span>
        </div>
        <h1 class="text-2xl sm:text-4xl font-semibold tracking-tighter mb-2 text-white">
          Receiving Files
        </h1>
        <p class="text-zinc-500 text-sm sm:text-base font-medium">
          Your connection is encrypted end-to-end
        </p>
      </div>

      <div class="max-w-md mx-auto">
        <!-- Default: Listening -->
        <div id="recvDefault"
          class="bg-card border border-white/[0.05] rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center shadow-2xl">
          <div
            class="w-14 h-14 mx-auto mb-5 bg-white/[0.03] border border-white/[0.05] rounded-xl flex items-center justify-center text-zinc-400">
            <svg class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
            </svg>
          </div>
          <p class="text-sm font-medium text-white/90 mb-2" id="receiverFilesText">
            Ready to receive
          </p>
          <div id="receiverStatus"
            class="flex items-center justify-center gap-2 text-zinc-500 text-xs sm:text-sm font-medium">
            <div class="w-1.5 h-1.5 rounded-full bg-success animate-pulse"></div>
            Connected and waiting
          </div>
        </div>

        <!-- Connecting state -->
        <div id="recvConnecting"
          class="hidden bg-card border border-white/[0.05] rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center shadow-2xl">
          <div
            class="w-14 h-14 mx-auto mb-5 bg-accent/10 rounded-xl flex items-center justify-center text-accent animate-pulse">
            <svg class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244" />
            </svg>
          </div>
          <h2 class="font-bold text-base sm:text-lg mb-1.5">Connecting...</h2>
          <p class="text-zinc-500 text-xs sm:text-sm font-medium">
            Setting up a direct connection
          </p>
        </div>

        <!-- Error -->
        <div id="recvError" class="hidden bg-card border border-danger/30 rounded-xl p-6 sm:p-8 text-center">
          <div class="w-12 h-12 mx-auto mb-3 text-danger">
            <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
            </svg>
          </div>
          <h2 class="text-lg font-bold mb-1">Couldn't connect</h2>
          <p class="text-zinc-400 text-sm" id="recvErrorMsg">
            The link may have expired. Ask the sender for a new one.
          </p>
          <a href="/p2p.html" class="inline-block mt-4 text-accent hover:underline text-sm font-semibold">
            Go back
          </a>
        </div>
      </div>
    </div>
  </main>

  <!-- Transfer Request Modal -->
  <div id="requestModal"
    class="fixed inset-0 bg-bg/80 backdrop-blur-md z-[500] hidden flex items-center justify-center p-4 sm:p-6">
    <div
      class="bg-card border border-border rounded-2xl p-6 sm:p-8 w-full max-w-sm shadow-2xl scale-95 transition-transform duration-300">
      <div class="w-14 h-14 bg-accent/10 rounded-xl flex items-center justify-center mx-auto mb-5">
        <svg class="w-7 h-7 text-accent" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
        </svg>
      </div>
      <h3 class="text-lg font-bold text-center mb-1.5">Someone is sending you files</h3>
      <p class="text-zinc-400 text-center text-sm mb-5" id="requestInfo">
        Waiting for details...
      </p>
      <div class="flex gap-3">
        <button onclick="respondToTransfer(false)"
          class="flex-1 py-3 px-4 rounded-xl border border-border font-medium text-sm hover:bg-white/5 transition active:scale-95">
          Decline
        </button>
        <button onclick="respondToTransfer(true)"
          class="flex-1 py-3 px-4 rounded-xl bg-accent text-white font-semibold text-sm hover:bg-accent/80 transition active:scale-95">
          Accept
        </button>
      </div>
    </div>
  </div>

  <!-- Name Modal -->
  <div id="nameModal"
    class="modal-overlay fixed inset-0 bg-bg/80 backdrop-blur-md z-[600] items-center justify-center p-4 sm:p-6">
    <div
      class="modal-content bg-card border border-white/[0.05] rounded-2xl p-6 sm:p-8 w-full max-w-sm shadow-2xl transition-all duration-300"
      id="nameModalCard">
      <h3 class="text-lg sm:text-xl font-semibold tracking-tight text-white mb-1.5">
        Your name
      </h3>
      <p class="text-zinc-500 text-sm font-medium mb-6 sm:mb-8">
        This is how others see you when sharing
      </p>

      <div class="relative mb-6 sm:mb-8">
        <input type="text" id="newNameInput"
          class="w-full bg-white/[0.02] border border-white/[0.05] rounded-full px-5 py-3.5 outline-none focus:border-white transition-colors text-white text-base"
          placeholder="Enter your name" maxlength="20" />
      </div>

      <div class="flex gap-3">
        <button onclick="closeNameModal()"
          class="flex-1 py-3 font-medium text-sm text-zinc-500 hover:text-white transition">
          Cancel
        </button>
        <button onclick="saveNameFromModal()"
          class="flex-1 py-3 rounded-full bg-white text-black font-semibold text-sm hover:opacity-90 transition active:scale-95">
          Save
        </button>
      </div>
    </div>
  </div>

  <footer
    class="py-5 border-t border-white/[0.04] w-full max-w-3xl mx-auto px-4 sm:px-6 flex flex-col sm:flex-row items-center justify-between gap-3">
    <div class="flex items-center gap-2">
      <div class="w-1.5 h-1.5 rounded-full bg-success animate-pulse"></div>
      <span class="text-zinc-500 text-xs sm:text-sm font-medium">Encrypted connection active</span>
    </div>
    <p class="text-zinc-600 text-xs sm:text-sm font-medium">GoShare</p>
  </footer>

  <div id="toastEl"
    class="fixed bottom-6 left-1/2 -translate-x-1/2 bg-card border border-white/[0.08] text-white px-5 py-2.5 rounded-xl text-sm font-medium shadow-lg transition-all duration-300 opacity-0 translate-y-4 pointer-events-none z-50">
    Copied!
  </div>

  <script src="/p2p.js"></script>
</body>

</html>